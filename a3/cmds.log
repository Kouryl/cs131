q1
  829  cut -f8,17 -d, 2019-08.csv | awk -F, 'NR > 1 { total[$1] += $3; count[$1]++ } END { for (i in total) { avg = total[i] / count[i]; print i "," avg }}' | sort -t, -k2 -nr | head -10 > a3.txt

q2
  841  cut -f8,9,17 -d, 2019-08.csv | awk -F, 'NR > 1 { total[$1","$2] += $3; count[$1","$2]++ } END { for (i in total) { avg = total[i] / count[i]; print i "," avg }}' | sort -t, -k3 -nr | head -10 >> a3.txt

q3
  815  cut -f4,14 -d, 2019-08.csv | awk -F, 'NR > 1 { tip[$1] += $2; count[$1]++ } END { for (i in tip) { print i "," tip[i]/count[i] }}' > a3t3.dat

q4
 1017  cut -f5,17 -d, 2019-08.csv > t4.csv
 1020  awk -F, 'NR > 1 { total[$1] += $2; count[$1] ++ } END { for (i in total) { print i "," total[i]/count[i] }}' t4.csv > a3t4.dat
